lwd = c(3,2, 2, 1),
legend.position = "bottomright")
head(full.model_apparent$derived.data)
head(full.model_apparent$derived.data)
head(full.model_cc$derived.data)
library(DecisionCurve)
full.model_cc <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData_cc,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none',
study.design = "case-control",
population.prevalence =rho)
head(full.model_apparent$derived.data)
head(full.model_cc$derived.data)
source("../decisioncurveanalysis/dca.r")
dcaData$model <- predict(cohort.glm, type = "response")
dca(data=dcaData, outcome="Cancer", predictors="famhistory", xstop=0.35)
dca(data=dcaData, outcome="Cancer", predictors="model", xstop=0.4)
class(dcaData)
dcaData
dca(data=data.frame(dcaData), outcome="Cancer", predictors="model", xstop=0.4)
dcaData_cc$model <- predict(cc.glm, type = "response")
dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4)
dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4, ylim = c(0, .5))
cc.glm
dcaData_cc$model <- predict(cc.glm, type = "response")
dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4, ylim = c(0, .5))
dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4, ymin = -0.05)
dca.coh <- dca(data=data.frame(dcaData), outcome="Cancer", predictors="model", xstop=0.4)
dca.cc <- dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4, ymin = -0.05)
plot(dca.coh$net.benefit, dca.cc$net.benefit)
head(dca.coh$net.benefit)
plot(dca.coh$net.benefit$model, dca.cc$net.benefit$model)
abline(0,1)
plot(dca.coh$net.benefit$model, dca.cc$net.benefit$model, ylim = c(0,1), xlim = c(0,1))
abline(0,1)
plot(dca.coh$net.benefit$model, full.model_apparent$derived.data$NB[1:n])
plot(dca.coh$net.benefit$model, full.model_apparent$derived.data$NB[1:N])
N
nrow(dcaData)
plot(dca.coh$net.benefit$model, full.model_apparent$derived.data$NB[1:n])
full.model_apparent$derived.data$NB[1:n]
nrow(full.model_apparent$derived.data)
123/3
plot(dca.coh$net.benefit$model, full.model_apparent$derived.data$NB[1:41])
nrow(dca.coh$net.benefit)
plot(dca.coh$net.benefit$model, full.model_apparent$derived.data$NB[1:40])
abline(0,1)
plot(dca.coh$net.benefit$model, full.model_apparent$derived.data$NB[2:41])
abline(0,1)
all.equal(dca.coh$net.benefit$model, full.model_apparent$derived.data$NB[2:41])
all.equal(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
dca.cc$net.benefit$model
plot(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
abline(0,1)
cbind(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
cbind(dca.cc$net.benefit$model, full.model_cohort$derived.data$NB[2:41])
cbind(dca.cc$net.benefit$model, full.model_apparent$derived.data$NB[2:41])
cbind(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
dca.cc$net.benefit$model
dcaData_cc$model <- fitted(cc.glm)
dcaData_cc$model
dca.cc <- dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4, ymin = -0.05)
cbind(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
library(DecisionCurve)
full.model_cc <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData_cc,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none',
study.design = "case-control",
population.prevalence =rho)
cc.roc <- roc(response = dcaData_cc$Cancer, predictor = fitted(glm(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData_cc, family = binomial())))
dcaData_cc$model <- fitted(cc.glm)
dca.cc <- dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4, ymin = -0.05)
cbind(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
cbind(dca.cc$net.benefit$model, dca.coh$net.benefit$model)
head(cbind(fitted(cc.glm), predict(cc.glm, type = "response")))
all.equal((fitted(cc.glm), predict(cc.glm, type = "response")))
all.equal(fitted(cc.glm), predict(cc.glm, type = "response"))
library(DecisionCurve)
dcaData_cc$model <- fitted(cc.glm)
dca.cc <- dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4, ymin = -0.05)
cbind(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
full.model_cc <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData_cc,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none',
study.design = "case-control",
population.prevalence =rho)
cbind(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
all.equal(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
mean(dcaData_cc$model)
myglm
mean(fitted(cohort.glm))
mean(fitted(cc.glm))
?fitted
?fitted.values
?predict.glm
dcaData_cc$myoff <- -log((rho)/ (1-rho)) + log((obs.rho)/(1-obs.rho))
cc.glm <- glm(Cancer~Age + Female + Smokes + Marker1 + Marker2 + offset(myoff), data = dcaData_cc,
??
)))
cc.glm2 <- glm(Cancer~Age + Female + Smokes + Marker1 + Marker2 + offset(myoff), data = dcaData_cc,
family = binomial())
plot(fitted(cc.glm2), fitted(cc.glm))
abline(0,1)
all.equal(fitted(cc.glm2), fitted(cc.glm))
head(dcaData$myof)
head(dcaData$myoff)
head(dcaData_cc$myoff)
?glm
all.equal(predict(cc.glm2), predict(cc.glm))
cc.glm2 <- glm(Cancer~Age + Female + Smokes + Marker1 + Marker2 ,
data = dcaData_cc,
family = binomial())
all.equal(predict(cc.glm2), predict(cc.glm))
?"predict.glm"
library(DecisionCurve)
full.model_cc <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData_cc,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none',
study.design = "case-control",
population.prevalence =rho)
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
confidence.intervals = 'none',
thresholds = seq(0, .4, by = .01))
plot_decision_curve( list(full.model_apparent, full.model_cc),
curve.names = c("cohort curve", "case-control curve"),
col = c("red", "blue"),
lty = c(2,1),
lwd = c(3,2, 2, 1),
legend.position = "bottomright")
plot_decision_curve( list(full.model_apparent, full.model_cc, full.model_true),
curve.names = c("cohort curve", "case-control curve", "truth"),
col = c("red", "blue", "magenta"),
lty = c(2,1, 1),
lwd = c(3,2, 2,2, 1),
legend.position = "bottomright")
dcaData_cc$model <- fitted(cc.glm)
dca.cc <- dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4, ymin = -0.05)
all.equal(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
rho
all.equal(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
all.equal(dca.cc$net.benefit$model, full.model_coh$derived.data$NB[2:41])
all.equal(dca.cc$net.benefit$model, full.model_apparent$derived.data$NB[2:41])
all.equal(dca.cc$net.benefit$model, full.model_cohort$derived.data$NB[2:41])
all.equal(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
cbind(dca.cc$net.benefit$model, dca.coh$net.benefit$model)
cbind(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
mean(ddcaData_cc$model)
obs.rho
dcaData_cc$model <- fitted(cc.glm) - log((rho)/ (1-rho)) + log((obs.rho)/(1-obs.rho))
head(full.model_apparent$derived.data)
head(full.model_cc$derived.data)
library(DecisionCurve)
full.model_cc <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData_cc,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none',
study.design = "case-control",
population.prevalence =rho)
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
confidence.intervals = 'none',
thresholds = seq(0, .4, by = .01))
plot_decision_curve( list(full.model_apparent, full.model_cc, full.model_true),
curve.names = c("cohort curve", "case-control curve", "truth"),
col = c("red", "blue", "magenta"),
lty = c(2,1, 1),
lwd = c(3,2, 2,2, 1),
legend.position = "bottomright")
head(full.model_apparent$derived.data)
head(full.model_cc$derived.data)
library(DecisionCurve)
full.model_cc <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData_cc,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none',
study.design = "case-control",
population.prevalence =rho)
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
confidence.intervals = 'none',
thresholds = seq(0, .4, by = .01))
plot_decision_curve( list(full.model_apparent, full.model_cc, full.model_true),
curve.names = c("cohort curve", "case-control curve", "truth"),
col = c("red", "blue", "magenta"),
lty = c(2,1, 1),
lwd = c(3,2, 2,2, 1),
legend.position = "bottomright")
head(full.model_apparent$derived.data)
head(full.model_apparent$derived.data)
head(full.model_cc$derived.data)
library(DecisionCurve)
plot(full.model_cc$derived.data$prob.high.risk, full.model_apparent$derived.data$prob.high.risk)
plot(full.model_cc$derived.data$prob.high.risk, full.model_apparent$derived.data$prob.high.risk)
abline(0,1)
head(full.model_apparent$derived.data)
full.model_cc <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData_cc,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none',
study.design = "case-control",
population.prevalence =rho)
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
confidence.intervals = 'none',
thresholds = seq(0, .4, by = .01))
plot_decision_curve( list(full.model_apparent, full.model_cc, full.model_true),
curve.names = c("cohort curve", "case-control curve", "truth"),
col = c("red", "blue", "magenta"),
lty = c(2,1, 1),
lwd = c(3,2, 2,2, 1),
legend.position = "bottomright")
head(full.model_apparent$derived.data)
head(full.model_cc$derived.data)
plot(full.model_cc$derived.data$prob.high.risk, full.model_apparent$derived.data$prob.high.risk)
abline(0,1)
dcaData_cc$model <- predict(cc.glm) - log((rho)/ (1-rho)) + log((obs.rho)/(1-obs.rho))
y <- predict(cc.glm) - log((rho)/ (1-rho)) + log((obs.rho)/(1-obs.rho))
dcaData_cc$model  <- exp(y)/(exp(y)+1)
dca.cc <- dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4, ymin = -0.05)
all.equal(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
cbind(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
all.equal(dca.cc$net.benefit$model, full.model_apparent$derived.data$NB[2:41])
library(DecisionCurve)
plot_roc_components(full.model_cv,  xlim = c(0, 0.4),
col = c("black", "red"))
plot_roc_components(full.model,  xlim = c(0, 0.4),
col = c("black", "red"))
full.model <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
bootstraps = 50)
plot_roc_components(full.model_apparent,  xlim = c(0, 0.4),
col = c("black", "red"))
plot_clinical_impact(full.model_apparent, xlim = c(0, .4),
col = c("black", "blue"))
plot_clinical_impact(full.model_cc, xlim = c(0, .4),
col = c("black", "blue"))
plot_roc_components(full.model_cv,  xlim = c(0, 0.4),
col = c("black", "red"))
plot_clinical_impact(full.model_cv, xlim = c(0, .4),
col = c("black", "blue"))
summary(full.model, nround = 2, measure = "TPR") #outputs standardized net benefit by default
summary(full.model, nround = 2, measure = "FPR") #outputs standardized net benefit by default
summary(full.model_cv, nround = 2, measure = "FPR") #outputs standardized net benefit by default
summary(full.model_cv, nround = 2, measure = "DP") #outputs standardized net benefit by default
summary(full.model_cv, nround = 2, measure = "sNB") #outputs standardized net benefit by default
library(DecisionCurve)
?cv_decision_curve
?cv_decision_curve
library(DecisionCurve)
library(DecisionCurve)
?cv_decision_curve
library(DecisionCurve)
?cv_decision_curve
data(dcaData)
full.model_cv <- cv_decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
folds = 5,
thresholds = seq(0, .4, by = .01))
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none')
head(full.model_cv$derived.data)
library(DecisionCurve)
?cv_decision_curve
?cv_decision_curve
library(DecisionCurve)
library(DecisionCurve)
?cv_decision_curve
install.packages("caret")
install.packages("caret")
library(caret)
library(DecisionCurve)
?Error
?Error
library(DecisionCurve)
n = 100000
dcaData <-
r_data_frame(
n = n,
age,
dummy(prob = c(.46, .54), name = "Female"),
smokes,
Marker1 = runif,
Marker2 = rnorm
)
attach(dcaData)
lp <-   -10 +  log(1.25)*Age + log(.75)*Female + log(2)*Smokes + log(3)*Marker1 + log(.2)*Marker2
detach(dcaData)
expit <- function(xx) exp(xx)/ (1+exp(xx))
logit <- function(xx) log(xx/(1-xx))
dcaData$truth = expit(lp)
dcaData$Cancer <- rbinom(n, size =1 , prob = expit(lp))
dcaData$Cancer
dcaData <-
r_data_frame(
n = n,
age,
dummy(prob = c(.46, .54), name = "Female"),
smokes,
Marker1 = runif,
Marker2 = rnorm
)
library(wakefield)
n = 100000
dcaData <-
r_data_frame(
n = n,
age,
dummy(prob = c(.46, .54), name = "Female"),
smokes,
Marker1 = runif,
Marker2 = rnorm
)
attach(dcaData)
lp <-   -10 +  log(1.25)*Age + log(.75)*Female + log(2)*Smokes + log(3)*Marker1 + log(.2)*Marker2
detach(dcaData)
expit <- function(xx) exp(xx)/ (1+exp(xx))
logit <- function(xx) log(xx/(1-xx))
dcaData$truth = expit(lp)
dcaData$Cancer <- rbinom(n, size =1 , prob = expit(lp))
all.ind <- 1:n
cc.ind  <- c(sample(all.ind[dcaData$Cancer == 1], size = 5000),
sample(all.ind[dcaData$Cancer ==0], size = 5000))
dcaData_cc <- dcaData[cc.ind, ]
cohort.glm <- glm(Cancer~Age + Female + Smokes + Marker1 + Marker2, data = dcaData, family = binomial())
rho <- mean(dcaData$Cancer)
obs.rho = mean(dcaData_cc$Cancer)
cc.glm <- glm(Cancer~Age + Female + Smokes + Marker1 + Marker2, data = dcaData_cc, family = binomial(),
offset =  -rep(log((rho)/ (1-rho)) + log((obs.rho)/(1-obs.rho)), nrow(dcaData_cc)))
dcaData_cc$myoff <- -log((rho)/ (1-rho)) + log((obs.rho)/(1-obs.rho))
cc.glm2 <- glm(Cancer~Age + Female + Smokes + Marker1 + Marker2 ,
data = dcaData_cc,
family = binomial())
true.coefs <- c(-10, log(1.25), log(.75), log(2), log(3), log(.2))
rbind(coef(cohort.glm), coef(cc.glm), true.coefs)
full.model_cv <- cv_decision_curve(Cancer~Age + Female + Smokes+ Marker1 + Marker2,
data = dcaData_cc,
folds = 5,
study.design = "case-control",
thresholds = seq(0, .4, by = .01),
population.prevalence = rho)
full.model_cv <- cv_decision_curve(Cancer~Age + Female + Smokes+ Marker1 + Marker2,
data = dcaData_cc,
folds = 5,
thresholds = seq(0, .4, by = .01),
study.design = "case-control",
population.prevalence = rho)
library(DecisionCurve)
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none')
full.model_true <- decision_curve(Cancer~truth,
data = dcaData,
fitted.risk = TRUE,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none')
plot_decision_curve( list(full.model_apparent, full.model_cv, full.model_true),
curve.names = c("Apparent curve", "Cross-validated curve", "True curve"),
col = c("red", "blue", "magenta"),
lty = c(2,1, 1),
lwd = c(3,2, 2, 2, 1),
legend.position = "bottomright")
library(DecisionCurve)
library(DecisionCurve)
library(DecisionCurve)
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none')
data("dcaData")
data("data/dcaData_cc.rda")
data("dcaData_cc")
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none')
plot_decision_curve(full.model_apparent)
plot_decision_curve(full.model_apparent)
plot_decision_curve(full.model_apparent, legend.position = "lowerright")
plot_decision_curve(full.model_apparent, legend.position = "bottomright")
full.model_true <- decision_curve(Cancer~truth,
data = dcaData,
fitted.risk = TRUE,
thresholds = seq(0, .4, by = .01),
bootstraps = 500)
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
thresholds = seq(0, .4, by = .01),
bootstraps = 500)
plot_decision_curve(full.model_apparent, legend.position = "bottomright")
plot_decision_curve(full.model_apparent, curve.names = c("mine", "yours"))
is.formula
aa <- Cancer ~ Age + smokes()
aa <- Cancer ~ Age + smokes
aa
class(aa)
all(thresholds >= 0)
thresholds = seq(0, 1, by = .01)
all(thresholds >= 0)
plot_decision_curve(full.model_apparent, curve.names = c(1))
library(DecisionCurve)
library(DecisionCurve)
library(DecisionCurve)
n = 10000
library(DecisionCurve)
library(wakefield)
n = 10000
dcaData <-
r_data_frame(
n = n,
age,
dummy(prob = c(.46, .54), name = "Female"),
smokes,
Marker1 = runif,
Marker2 = rnorm
)
attach(dcaData)
lp <-   -10 +  log(1.25)*Age + log(.75)*Female + log(2)*Smokes + log(3)*Marker1 + log(.2)*Marker2
detach(dcaData)
expit <- function(xx) exp(xx)/ (1+exp(xx))
logit <- function(xx) log(xx/(1-xx))
dcaData$truth = expit(lp)
dcaData$Cancer <- rbinom(n, size =1 , prob = expit(lp))
all.ind <- 1:n
table(dcaData$Cancer)
all.ind <- 1:n
cc.ind  <- c(sample(all.ind[dcaData$Cancer == 1], size = 1000),
sample(all.ind[dcaData$Cancer ==0], size = 1000))
dcaData_cc <- dcaData[cc.ind, ]
cohort.glm <- glm(Cancer~Age + Female + Smokes + Marker1 + Marker2, data = dcaData, family = binomial())
rho <- mean(dcaData$Cancer)
obs.rho = mean(dcaData_cc$Cancer)
cc.glm <- glm(Cancer~Age + Female + Smokes + Marker1 + Marker2, data = dcaData_cc, family = binomial(),
offset =  -rep(log((rho)/ (1-rho)) + log((obs.rho)/(1-obs.rho)), nrow(dcaData_cc)))
dcaData_cc$myoff <- -log((rho)/ (1-rho)) + log((obs.rho)/(1-obs.rho))
cc.glm2 <- glm(Cancer~Age + Female + Smokes + Marker1 + Marker2 ,
data = dcaData_cc,
family = binomial())
true.coefs <- c(-10, log(1.25), log(.75), log(2), log(3), log(.2))
rbind(coef(cohort.glm), coef(cc.glm), true.coefs)
full.model_cc <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData_cc,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none',
study.design = "case-control",
population.prevalence =rho)
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
confidence.intervals = 'none',
thresholds = seq(0, .4, by = .01))
plot_decision_curve( list(full.model_apparent, full.model_cc, full.model_true),
curve.names = c("cohort curve", "case-control curve", "truth"),
col = c("red", "blue", "magenta"),
lty = c(2,1, 1),
lwd = c(3,2, 2,2, 1),
legend.position = "bottomright")
full.model_true <- decision_curve(Cancer~truth,
data = dcaData,
fitted.risk = TRUE,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none')
plot_decision_curve( list(full.model_apparent, full.model_cc, full.model_true),
curve.names = c("cohort curve", "case-control curve", "truth"),
col = c("red", "blue", "magenta"),
lty = c(2,1, 1),
lwd = c(3,2, 2,2, 1),
legend.position = "bottomright")
plot_decision_curve( list(full.model_apparent, full.model_cc, full.model_true),
curve.names = c("cohort curve", "case-control curve", "truth"),
col = c("red", "blue", "magenta"),
lty = c(2,1, 1),
lwd = c(3,2, 2,2, 1),
legend.position = "bottomright")
full.model_cv <- cv_decision_curve(Cancer~Age + Female + Smokes+ Marker1 + Marker2,
data = dcaData_cc,
folds = 5,
study.design = "case-control",
thresholds = seq(0, .4, by = .01),
population.prevalence = rho)
full.model_apparent <- decision_curve(Cancer~Age + Female + Smokes + Marker1 + Marker2,
data = dcaData,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none')
full.model_true <- decision_curve(Cancer~truth,
data = dcaData,
fitted.risk = TRUE,
thresholds = seq(0, .4, by = .01),
confidence.intervals = 'none')
plot_decision_curve( list(full.model_apparent, full.model_cv, full.model_true),
curve.names = c("Apparent curve", "Cross-validated curve", "True curve"),
col = c("red", "blue", "magenta"),
lty = c(2,1, 1),
lwd = c(3,2, 2, 2, 1),
legend.position = "bottomright")
source("../decisioncurveanalysis/dca.r")
dcaData$model <- predict(cohort.glm, type = "response")
dca.coh <- dca(data=data.frame(dcaData), outcome="Cancer", predictors="model", xstop=0.4)
all.equal(dca.coh$net.benefit$model, full.model_apparent$derived.data$NB[2:41])
y <- predict(cc.glm) - log((rho)/ (1-rho)) + log((obs.rho)/(1-obs.rho))
dcaData_cc$model  <- exp(y)/(exp(y)+1)
dca.cc <- dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.4, ymin = -0.05)
all.equal(dca.cc$net.benefit$model, full.model_cc$derived.data$NB[2:41])
dca.cc <- dca(data=data.frame(dcaData_cc), outcome = "Cancer", predictors = "model", xstop = 0.6, ymin = -0.05)
dca.coh <- dca(data=data.frame(dcaData), outcome="Cancer", predictors="model", xstop=0.6)
